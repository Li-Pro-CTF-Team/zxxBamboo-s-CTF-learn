from Crypto.Cipher import DES

# 已知的弱密钥和半弱密钥
weak_keys = [
    b'\x01\x01\x01\x01\x01\x01\x01\x01',
    b'\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE',
    b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',
    b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',
    b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',
    b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',
    b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',
    b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',
    b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',
    b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',
    b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',
    b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',
    b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',
    b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',
    b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',
    b'\xFE\xE0\xFE\xE0\xFE\xF1\xFE\xF1',
]

# 题目给出的密文
ciphertext = b'\x84\xff\xe5x\x173\nVcQ\x99\xa8o\xbf\xb3\xfe/e\xaa\x84\x03\xee\xaa\x92\x8a\xb8L\xc4B\xa0\x05}'

# 尝试所有弱密钥
for key in weak_keys:
    des = DES.new(key, DES.MODE_ECB)
    plaintext = des.decrypt(ciphertext)
    print(plaintext)
